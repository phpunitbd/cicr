<?xml version="1.0"?>
<config>
  <modules>
    <Data_Icrc>
      <version>0.2.30</version>
    </Data_Icrc>
  </modules>
  <global>
    <models>
      <data_icrc>
        <class>Data_Icrc_Model</class>
        <resourceModel>data_icrc_resource</resourceModel>
      </data_icrc>
      <data_icrc_resource>
        <class>Data_Icrc_Model_Resource</class>
        <entities>
          <sku_mapping>
            <table>icrc_sku_mapping</table>
          </sku_mapping>
          <datastudio_log>
            <table>icrc_datastudio_log</table>
          </datastudio_log>
          <payment_pending>
            <table>icrc_payment_pending</table>
          </payment_pending>
          <order_attribute>
            <table>order_attribute</table>app
          </order_attribute>
          <order_attribute_value>
            <table>order_attribute_value</table>
          </order_attribute_value>
          <order_attribute_label>
            <table>order_attribute_label</table>
          </order_attribute_label>
          <order_attribute_defaults>
            <table>order_attribute_defaults</table>
          </order_attribute_defaults>
          <order_grid_collection>
          </order_grid_collection>
          <customer_billing_info>
            <table>icrc_customer_billing_info</table>
          </customer_billing_info>
          <radar_acronym>
            <table>radar_acronym</table>
          </radar_acronym>
          <radar_delegation>
            <table>radar_delegation</table>
          </radar_delegation>
          <radar_costcenter>
            <table>radar_costcenter</table>
          </radar_costcenter>
          <radar_objective>
            <table>radar_objective</table>
          </radar_objective>
          <productdeleted>
              <table>icrc_product_deleted</table>
          </productdeleted>
        </entities>
      </data_icrc_resource>
      <dataadminthemecontroller>
         <class>Data_Icrc_Controller</class>
      </dataadminthemecontroller>
      <catalog>
        <rewrite>
          <product>Data_Icrc_Model_Catalog_Product</product>
          <layer>Data_Icrc_Model_Catalog_Layer</layer>
          <product_api>Data_Icrc_Model_Product_Api</product_api>
          <product_api_v2>Data_Icrc_Model_Product_Api2</product_api_v2>
          <product_attribute_media_api_v2>Data_Icrc_Model_Catalog_Product_Attribute_Media_Api2</product_attribute_media_api_v2>
          <config>Data_Icrc_Model_Catalog_Config</config>
          <product_status>Data_Icrc_Model_Catalog_Product_Status</product_status>
        </rewrite>
      </catalog>
      <catalogsearch>
        <rewrite>
          <layer>Data_Icrc_Model_CatalogSearch_Layer</layer>
        </rewrite>
      </catalogsearch>
      <catalogsearch_resource>
          <rewrite>
            <fulltext>Data_Icrc_Model_CatalogSearch_Resource_Fulltext</fulltext>
          </rewrite>
      </catalogsearch_resource>
      <cataloginventory>
        <rewrite>
          <stock_item>Data_Icrc_Model_CatalogInventory_Stock_Item</stock_item>
        </rewrite>
      </cataloginventory>
      <sales>
        <rewrite>
          <order>Data_Icrc_Model_Sales_Order</order>
          <order_config>Data_Icrc_Model_Sales_Order_Config</order_config>
          <order_api>Data_Icrc_Model_Sales_Order_Api</order_api>
          <order_api_v2>Data_Icrc_Model_Sales_Order_Api_V2</order_api_v2>
          <order_pdf_invoice>Data_Icrc_Model_Order_Pdf_Invoice</order_pdf_invoice>
          <order_pdf_items_invoice_default>Data_Icrc_Model_Sales_Order_Pdf_Items_Invoice_Default</order_pdf_items_invoice_default>
          <order_pdf_total_default>Data_Icrc_Model_Sales_Order_Pdf_Total_Default</order_pdf_total_default>
          <order_address>Data_Icrc_Model_Order_Address</order_address>
          <quote_address>Data_Icrc_Model_Sales_Quote_Address</quote_address>
        </rewrite>
      </sales>
      <api>
        <rewrite>
          <server_wsi_adapter_soap>Data_Icrc_Model_Server_Soapadapter</server_wsi_adapter_soap>
        </rewrite>
      </api>
      <checkout>
        <rewrite>
          <session>Data_Icrc_Model_Checkout_Session</session>
        </rewrite>
      </checkout>
      <customer>
        <rewrite>
          <form>Data_Icrc_Model_Customer_Form</form>
        </rewrite>
      </customer>
      <directory>
        <rewrite>
          <currency>Data_Icrc_Model_Currency</currency>
        </rewrite>
      </directory>
      <core>
        <rewrite>
          <session>Data_Icrc_Model_Session</session>
        </rewrite>
      </core>
      <tax>
        <rewrite>
          <sales_pdf_grandtotal>Data_Icrc_Model_Tax_Sales_Pdf_Grandtotal</sales_pdf_grandtotal>
          <sales_pdf_tax>Data_Icrc_Model_Tax_Sales_Pdf_Tax</sales_pdf_tax>
          <sales_pdf_subtotal>Data_Icrc_Model_Tax_Sales_Pdf_Subtotal</sales_pdf_subtotal>
          <sales_pdf_shipping>Data_Icrc_Model_Tax_Sales_Pdf_Shipping</sales_pdf_shipping>
        </rewrite>
      </tax>
      <eav>
          <rewrite>
              <entity_attribute_backend_time_updated>Data_Icrc_Model_Eav_Entity_Attribute_Backend_Time_Updated</entity_attribute_backend_time_updated>
          </rewrite>
      </eav>
      <reports_resource>
          <rewrite>
              <product_collection>Data_Icrc_Model_Resource_Reports_Product_Collection</product_collection>
          </rewrite>
      </reports_resource>
      <data_icrc>
        <class>Data_Icrc_Model</class>
      </data_icrc>
      <productalert>
          <rewrite>
              <observer>Data_Icrc_Model_ProductAlert_Observer</observer>
          </rewrite>
      </productalert>
    </models>
    <blocks>
      <page>
        <rewrite>
          <html_topmenu>Data_Icrc_Block_Topmenu</html_topmenu>
        </rewrite>
        <rewrite>
          <html_head>Data_Icrc_Block_Page_html_Head</html_head>
        </rewrite>
      </page>
      <catalog>
      </catalog>
      <adminhtml>
        <rewrite>
          <catalog_product_grid>Data_Icrc_Block_Adminhtml_Product_Grid</catalog_product_grid>
        </rewrite>
        <rewrite>
          <sales_order_grid>Data_Icrc_Block_Adminhtml_Order_Grid</sales_order_grid>
        </rewrite>
        <rewrite>
          <sales_items_renderer_default>Data_Icrc_Block_Adminhtml_Sales_Items_Renderer_Default</sales_items_renderer_default>
        </rewrite>
        <rewrite>
          <sales_order_create_billing_method_form>Data_Icrc_Block_Payment_Form_Container</sales_order_create_billing_method_form>
        </rewrite>
        <rewrite>
          <customer_edit_tab_addresses>Data_Icrc_Block_Adminhtml_Customer_Edit_Tab_Addresses</customer_edit_tab_addresses>
        </rewrite>
        <rewrite>
          <page_head>Data_Icrc_Block_Page_Html_Adminhtml_Head</page_head>
        </rewrite>
      </adminhtml>
      <checkout>
        <rewrite>
          <onepage_payment_methods>Data_Icrc_Block_Payment_Methods</onepage_payment_methods>
        </rewrite>
      </checkout>
      <icrc>
        <class>Data_Icrc_Block</class>
      </icrc>
      <data_icrc>
        <class>Data_Icrc_Block</class>
      </data_icrc>
      <customer>
        <rewrite>
          <address_book>Data_Icrc_Block_Customer_Address_Book</address_book>
        </rewrite>
      </customer>
      <reports>
        <rewrite>
          <product_viewed>Data_Icrc_Block_Product_Viewed</product_viewed>
        </rewrite>
      </reports>
    </blocks>
    <helpers>
      <data_icrc>
        <class>Data_Icrc_Helper</class>
      </data_icrc>
      <customer>
        <rewrite>
          <address>Data_Icrc_Helper_Override_Customer_Address</address>
        </rewrite>
      </customer>
    </helpers>
    <resources>
      <dataicrc_setup>
        <setup>
          <module>Data_Icrc</module>
        </setup>
        <connection>
          <use>core_setup</use>
        </connection>
      </dataicrc_setup>
    </resources>
    <events>
      <adminhtml_controller_action_predispatch_start>
        <observers>
          <data_themeoverride_observer>
            <type>singleton</type>
            <class>data_icrc/observer_predispatch</class>
            <method>overrideTheme</method>
          </data_themeoverride_observer>
          <data_totp_observer>
            <type>singleton</type>
            <class>data_icrc/observer_predispatch</class>
            <method>checkTotp</method>
          </data_totp_observer>
        </observers>
      </adminhtml_controller_action_predispatch_start>
      <admin_user_authenticate_before>
        <observers>
          <data_admin_login_observer>
            <type>singleton</type>
            <class>data_icrc/observer_admin</class>
            <method>onUserAuthenticateBefore</method>
          </data_admin_login_observer>
        </observers>
      </admin_user_authenticate_before>
      <catalog_product_save_before>
        <observers>
          <data_product_observer>
            <type>singleton</type>
            <class>data_icrc/observer_catalog</class>
            <method>serializeCatalogProductMultiselectArrays</method>
          </data_product_observer>
        </observers>
      </catalog_product_save_before>
      <controller_action_predispatch>
        <observers>
          <controller_action_predispatch_observer>
            <type>singleton</type>
            <class>data_icrc/observer_predispatch</class>
            <method>actionPreDispatch</method>
          </controller_action_predispatch_observer>
        </observers>
      </controller_action_predispatch>
      <!--controller_action_predispatch_customer_account_createpost-->
      <customer_register_success>
        <observers>
          <create_user_icrc>
            <type>singleton</type>
            <class>data_icrc/observer_customer</class>
            <method>onCreate</method>
          </create_user_icrc>
        </observers>
      <!--/controller_action_predispatch_customer_account_createpost--></customer_register_success>
      <sales_model_service_quote_submit_before>
        <observers>
          <create_user_icrc>
            <type>singleton</type>
            <class>data_icrc/observer_customer</class>
            <method>onSubmitOrder</method>
          </create_user_icrc>
        </observers>
      </sales_model_service_quote_submit_before>
      <controller_action_predispatch_contacts_index_post>
        <observers>
          <contacts_captcha>
            <type>singleton</type>
            <class>data_icrc/observer_captcha</class>
            <method>contactCheck</method>
          </contacts_captcha>
        </observers>
      </controller_action_predispatch_contacts_index_post>
    <controller_action_predispatch_icrc_otherlanguage_post>
        <observers>
            <otherlanguage_captcha>
                <type>singleton</type>
                <class>data_icrc/observer_captcha</class>
                <method>otherlanguageCheck</method>
            </otherlanguage_captcha>
        </observers>
    </controller_action_predispatch_icrc_otherlanguage_post>
      <catalog_block_product_list_collection>
        <observers>
          <product_list_collection>
            <type>singleton</type>
            <class>data_icrc/observer_catalog</class>
            <method>productListCollection</method>
          </product_list_collection>
        </observers>
      </catalog_block_product_list_collection>
      <customer_address_format>
        <observers>
          <format>
            <type>singleton</type>
            <class>data_icrc/observer_customer</class>
            <method>addressFormat</method>
          </format>
        </observers>
      </customer_address_format>
      <catalog_product_delete_before>
        <observers>
            <save_product_delete_before>
                <type>singleton</type>
                <class>data_icrc/observer_catalog</class>
                <method>saveProductDeleteBefore</method>
            </save_product_delete_before>
        </observers>
    </catalog_product_delete_before>
    </events>
    <pdf>
        <totals>
            <subtotal>
                <sort_order>200</sort_order>
            </subtotal>
            <discount>
                <sort_order>100</sort_order>
            </discount>
            <tax>
                <sort_order>400</sort_order>
            </tax>
            <shipping>
                <sort_order>300</sort_order>
            </shipping>
            <adjustment_positive>
                <sort_order>500</sort_order>
            </adjustment_positive>
            <adjustment_negative>
                <sort_order>600</sort_order>
            </adjustment_negative>
            <grand_total>
                <sort_order>700</sort_order>
            </grand_total>
        </totals>
    </pdf>
  </global>
  <admin>
  	<routers>
  		<adminhtml>
  			<args>
  				<modules>
  					<data_icrc before="Mage_Adminhtml">Data_Icrc_Adminhtml</data_icrc>
  				</modules>
  			</args>
  		</adminhtml>
  	</routers>
  </admin>

  <adminhtml>
    <events>
      <salesrule_rule_condition_combine>
        <observers>
          <data_icrc_rules>
            <class>data_icrc/observer_rules</class>
            <method>addConditionToSalesRule</method>
          </data_icrc_rules>
        </observers>
      </salesrule_rule_condition_combine>
      <adminhtml_sales_order_create_process_data>
        <observers>
          <data_icrc_order_cpd>
            <class>data_icrc/observer_adminhtml_order</class>
            <method>createProcessData</method>
          </data_icrc_order_cpd>
        </observers>
      </adminhtml_sales_order_create_process_data>
        <catalog_product_save_after>
            <observers>
                <set_custom_attribute>
                    <type>singleton</type>
                    <class>data_icrc/observer_catalog</class>
                    <method>setCustomAttribute</method>
                </set_custom_attribute>
            </observers>
        </catalog_product_save_after>
    </events>
  </adminhtml>

  <frontend>
    <routers>

  		<icrc>
        <use>standard</use>
  			<args>
					<module>Data_Icrc</module>
          <frontName>icrc</frontName>
  			</args>
  		</icrc>

  		<checkout>
  			<args>
					<modules>
						<Data_Icrc before="Mage_Checkout">Data_Icrc</Data_Icrc>
					</modules>
  			</args>
  		</checkout>
  		<customer>
  			<args>
					<modules>
						<Data_Icrc before="Mage_Customer">Data_Icrc_Customer</Data_Icrc>
					</modules>
  			</args>
  		</customer>
  		<sales>
  			<args>
					<modules>
						<Data_Icrc before="Mage_Sales">Data_Icrc_Sales</Data_Icrc>
					</modules>
  			</args>
  		</sales>

    </routers>
  </frontend>
  <default>
    <carriers>
      <icrc>
        <active>0</active>
        <sallowspecific>0</sallowspecific>
        <model>data_icrc/carrier_icrcSwissPost</model>
        <name>Swiss Post ICRC Shipping Method</name>
        <price>0</price>
        <title>Swiss Post</title>
        <type>I</type>
        <specificerrmsg>This shipping method is currently unavailable. If you would like to ship using this shipping method, please contact us.</specificerrmsg>
        <handling_type>F</handling_type>
      </icrc>
      <icrc_internal>
        <active>0</active>
        <sallowspecific>0</sallowspecific>
        <model>data_icrc/carrier_icrcInternal</model>
        <name>ICRC Logistic Shipping Method</name>
        <price>0</price>
        <title>ICRC Logistic</title>
        <type>I</type>
        <specificerrmsg>This shipping method is currently unavailable. If you would like to ship using this shipping method, please contact us.</specificerrmsg>
        <handling_type>F</handling_type>
      </icrc_internal>
    </carriers>
    <payment>
      <icrc>
        <active>0</active>
        <model>data_icrc/internalPaymentMethod</model>
        <title>ICRC Internal Invoice</title>
        <payment_action>authorize_capture</payment_action>
        <allowspecific>0</allowspecific>
      </icrc>
    </payment>
    <captcha  translate="label">
      <frontend>
          <areas>
            <contact>
              <label>Send contact message</label>
            </contact>
            <newsletter>
              <label>Register to newsletter</label>
            </newsletter>
        </areas>
      </frontend>
    </captcha>

    <icrc>
      <datastudio>
        <endpoint>http://localhost:8118</endpoint>
        <watchdog>1</watchdog>
      </datastudio>
      <web>
        <welcome>Shop</welcome>
        <submessage>of the International Committee of the Red Cross</submessage>
        <footer_logo>images/Logo-ICRC-footer.png</footer_logo>
        <language_available_message>To download these languages (not available on this website), please contact us</language_available_message>
        <contact_message>Dear customer, welcome to the ICRC shop.
Please fill in the following form, we will answer you as soon as possible.</contact_message>
        <contact_exhibition_message>Exhibitions cannot be ordered directly.
Please fill in the following form to request one, we will answer you as soon as possible.</contact_exhibition_message>
        <cart_image>images/icrc-small-cart.png</cart_image>
        <big_cart_image>images/icrc-cart.png</big_cart_image>
        <add_to_cart_image>images/Bouton-order-EN-2.png</add_to_cart_image>
        <contact_us_image>images/Bouton-order-EN-2.png</contact_us_image>
        <add_to_big_cart_image>images/Bouton-order-EN-2.png</add_to_big_cart_image>
      </web>
      <output>
        <pdf_logo_max_height>90</pdf_logo_max_height>
        <pdf_logo_max_width>200</pdf_logo_max_width>
      </output>
      <janus>
        <enable>1</enable>
      </janus>
    </icrc>
  </default>
  <stores>
    <admin>
      <design>
        <package>
          <name>default</name>
        </package>
        <theme>
          <default>icrc</default>
        </theme>
      </design>
    </admin>
  </stores>
  <crontab>
    <jobs>
      <data_icrc_related>
        <schedule><cron_expr>0 10 * * *</cron_expr></schedule>
        <run><model>data_icrc/cron::related</model></run>
      </data_icrc_related>
      <data_icrc_upsell>
        <schedule><cron_expr>0 9 * * *</cron_expr></schedule>
        <run><model>data_icrc/cron::upsell</model></run>
	</data_icrc_upsell>
      <data_icrc_ds_watchdog>
        <schedule><cron_expr>30 * * * *</cron_expr></schedule>
        <run><model>data_icrc/cron::datastudioInterfaceWatchdog</model></run>
      </data_icrc_ds_watchdog>
      <data_icrc_purge_pending_payment>
        <schedule><cron_expr>15 * * * *</cron_expr></schedule>
        <run><model>data_icrc/cron::cancelOldExternalPendingPayment</model></run>
      </data_icrc_purge_pending_payment>
    </jobs>
  </crontab>
</config>
